#!/bin/bash

# Modern Color Palette for MAPTECH GLOBAL
RED='\033[1;31m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
BLUE='\033[1;34m'
PURPLE='\033[1;35m'
CYAN='\033[1;36m'
WHITE='\033[1;37m'
GRAY='\033[1;90m'
RESET='\033[0m'

# Gradient Colors
NEON_GREEN='\033[38;5;46m'
NEON_BLUE='\033[38;5;51m'
NEON_PURPLE='\033[38;5;129m'
ELECTRIC_BLUE='\033[38;5;33m'
GOLD='\033[38;5;220m'

# Unicode Characters
ARROW="‚û§"
CHECK_MARK="‚úÖ"
CROSS_MARK="‚ùå"
GEAR="‚öôÔ∏è"
SHIELD="üõ°Ô∏è"
GLOBE="üåê"
ROCKET="üöÄ"
DIAMOND="üíé"
HEART="‚ù§Ô∏è"
CLOCK="üïê"

# Legacy compatibility
cor1='\033[41;1;37m'
cor2='\033[44;1;37m'
scor='\033[0m'
SCOLOR='\033[0m'

[[ $(awk -F" " '{print $2}' /usr/lib/licence) == "@DRAGON_VPS_MANAGER" ]] && {
	ram1=$(free -h | grep -i mem | awk {'print $2'})
	ram2=$(free -h | grep -i mem | awk {'print $4'})
	ram3=$(free -h | grep -i mem | awk {'print $3'})
	uso=$(top -bn1 | awk '/Cpu/ { cpu = "" 100 - $8 "%" }; END { print cpu }')
	system=$(cat /etc/issue.net)

	# Modern Header
	print_header() {
		clear
		echo -e "${NEON_BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${RESET}"
		echo -e "${NEON_BLUE}‚ïë${BLUE}${WHITE}                    MAPTECH SSH SCRIPT                     ${RESET}${NEON_BLUE}‚ïë${RESET}"
		echo -e "${NEON_BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${RESET}"
	}

	# Modern Footer
	print_footer() {
		echo ""
		echo -e "${ELECTRIC_BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${RESET}"
		echo -e "${ELECTRIC_BLUE}‚ïë${BLUE}${WHITE} MAPTECH GLOBAL ¬© 2025 ${NEON_BLUE}| ${SHIELD} @maptechgh ${HEART}${RESET}${ELECTRIC_BLUE}‚ïë${RESET}"
		echo -e "${ELECTRIC_BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${RESET}"
	}

	fun_bar() {
		comando[0]="$1"
		comando[1]="$2"
		(
			[[ -e $HOME/fim ]] && rm $HOME/fim
			[[ ! -d /etc/VPSManager ]] && rm -rf /bin/menu
			${comando[0]} >/dev/null 2>&1
			${comando[1]} >/dev/null 2>&1
			touch $HOME/fim
		) >/dev/null 2>&1 &
		tput civis
		echo -ne "${NEON_BLUE}${GEAR} ${WHITE}Processing ${CYAN}["
		while true; do
			for ((i = 0; i < 25; i++)); do
				echo -ne "${NEON_GREEN}‚ñà"
				sleep 0.06s
			done
			[[ -e $HOME/fim ]] && rm $HOME/fim && break
			echo -e "${CYAN}]"
			sleep 1s
			tput cuu1
			tput dl1
			echo -ne "${NEON_BLUE}${GEAR} ${WHITE}Processing ${CYAN}["
		done
		echo -e "${CYAN}] ${NEON_GREEN}${CHECK_MARK} ${WHITE}DONE${RESET}"
		tput cnorm
	}

	verif_ptrs() {
		porta=$1
		PT=$(lsof -V -i tcp -P -n | grep -v "ESTABLISHED" | grep -v "COMMAND" | grep "LISTEN")
		for pton in $(echo -e "$PT" | cut -d: -f2 | cut -d' ' -f1 | uniq); do
			svcs=$(echo -e "$PT" | grep -w "$pton" | awk '{print $1}' | uniq)
			[[ "$porta" = "$pton" ]] && {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}PORT ${YELLOW}$porta ${WHITE}IN USE BY ${GOLD}$svcs${RESET}"
				sleep 3
				fun_conexao
			}
		done
	}

	inst_sqd() {
		if netstat -nltp | grep 'squid' 1>/dev/null 2>/dev/null; then
			print_header
			echo -e "${RED}${CROSS_MARK} ${WHITE}REMOVE SQUID PROXY${RESET}"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}REALLY WANT TO REMOVE SQUID ${RED}? ${YELLOW}[s/n]:${WHITE} "
			read resp
			[[ "$resp" = 's' ]] && {
				echo -e "\n${GREEN}${GEAR} ${WHITE}REMOVING SQUID PROXY...${RESET}"
				echo ""
				rem_sqd() {
					[[ -d "/etc/squid" ]] && {
						apt-get remove squid -y >/dev/null 2>&1
						apt-get purge squid -y >/dev/null 2>&1
						rm -rf /etc/squid >/dev/null 2>&1
					}
					[[ -d "/etc/squid3" ]] && {
						apt-get remove squid3 -y >/dev/null 2>&1
						apt-get purge squid3 -y >/dev/null 2>&1
						rm -rf /etc/squid3 >/dev/null 2>&1
						apt autoremove -y >/dev/null 2>&1
					}
				}
				fun_bar 'rem_sqd'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SQUID SUCCESSFULLY REMOVED!${RESET}"
				sleep 2
				fun_conexao
			} || {
				echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 2
				fun_conexao
			}
		else
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}SQUID INSTALLER${RESET}"
			echo ""
			IP=$(wget -qO- ipv4.icanhazip.com)
			echo -ne "${GREEN}${ARROW} ${WHITE}CONFIRM YOUR IP: ${GOLD}"
			read -e -i $IP ipdovps
			[[ -z "$ipdovps" ]] && {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid IP${RESET}"
				echo ""
				read -p "Enter your IP: " IP
			}
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}WHICH PORTS DO YOU WANT TO USE? ${YELLOW}EX: ${WHITE}80 8080"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}INFORM THE PORTS: ${GOLD}"
			read portass
			[[ -z "$portass" ]] && {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}INVALID PORT!"
				sleep 3
				fun_conexao
			}
			for porta in $(echo -e $portass); do
				verif_ptrs $porta
			done
			[[ $(grep -wc '14' /etc/issue.net) != '0' ]] || [[ $(grep -wc '8' /etc/issue.net) != '0' ]] && {
				echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING SQUID PROXY${RESET}\n"
				fun_bar 'apt update -y' "apt install squid3 -y"
			} || {
				echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}SQUID VERSION 3.3.X          ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}SQUID VERSION 3.5.X          ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
				read -p "$(echo -e "${GREEN}${ARROW} ${WHITE}ENTER OPTION: ${GOLD}")" -e -i 1 opc
				[[ -z "$opc" ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid option!"
					sleep 2
					fun_conexao
				}
				[[ "$opc" != '1' ]] && {
					[[ "$opc" != '2' ]] && {
						echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid option!"
						sleep 2
						fun_conexao
					}
				}
				echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING SQUID PROXY${RESET}\n"
				fun_bar 'apt update -y' "instsqd $opc"
			}
			if [[ -d "/etc/squid/" ]]; then
				var_sqd="/etc/squid/squid.conf"
				var_pay="/etc/squid/payload.txt"
			elif [[ -d "/etc/squid3/" ]]; then
				var_sqd="/etc/squid3/squid.conf"
				var_pay="/etc/squid3/payload.txt"
			else
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}SQUID PROXY CORRUPT${RESET}"
				sleep 2
				fun_conexao
			fi
			cat <<-EOF >$var_pay
				.whatsapp.net/
				.facebook.net/
				.twitter.com/
				.speedtest.net/
			EOF
			cat <<-EOF >$var_sqd
				acl url1 dstdomain -i 127.0.0.1
				acl url2 dstdomain -i localhost
				acl url3 dstdomain -i $ipdovps
				acl url4 dstdomain -i /VPSMANAGER?
				acl payload url_regex -i "$var_pay"
				acl all src 0.0.0.0/0

				http_access allow url1
				http_access allow url2
				http_access allow url3
				http_access allow url4
				http_access allow payload
				http_access deny all
				 
				#Portas
			EOF
			for Pts in $(echo -e $portass); do
				echo -e "http_port $Pts" >>$var_sqd
				[[ -f "/usr/sbin/ufw" ]] && ufw allow $Pts/tcp
			done
			cat <<-EOF >>$var_sqd
				#Nome squid
				visible_hostname VPSMANAGER 
				via off
				forwarded_for off
				pipeline_prefetch off
			EOF
			sqd_conf() {
				[[ -d "/etc/squid/" ]] && {
					service ssh restart
					/etc/init.d/squid restart
					service squid restart
				}
				[[ -d "/etc/squid3/" ]] && {
					service ssh restart
					/etc/init.d/squid3 restart
					service squid3 restart
				}
			}
			echo -e "\n${GREEN}${GEAR} ${WHITE}CONFIGURING SQUID PROXY${RESET}"
			echo ""
			fun_bar 'sqd_conf'
			echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SQUID INSTALLED SUCCESSFULLY!${RESET}"
			sleep 2.5s
			fun_conexao
		fi
	}

	addpt_sqd() {
		print_header
		echo -e "${NEON_BLUE}${GEAR} ${WHITE}ADD PORT TO SQUID${RESET}"
		echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS IN USE: ${GREEN}$sqdp\n"
		if [[ -f "/etc/squid/squid.conf" ]]; then
			var_sqd="/etc/squid/squid.conf"
		elif [[ -f "/etc/squid3/squid.conf" ]]; then
			var_sqd="/etc/squid3/squid.conf"
		else
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}SQUID IS NOT INSTALLED!${RESET}"
			echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
			sleep 2
			fun_squid
		fi
		echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO ADD ${YELLOW}? ${GOLD}"
		read pt
		[[ -z "$pt" ]] && {
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid port!"
			sleep 2
			fun_conexao
		}
		verif_ptrs $pt
		echo -e "\n${GREEN}${GEAR} ${WHITE}ADDING PORT TO SQUID!"
		echo ""
		sed -i "s/#Portas/#Portas\nhttp_port $pt/g" $var_sqd
		fun_bar 'sleep 2'
		echo -e "\n${GREEN}${GEAR} ${WHITE}RESTARTING SQUID!"
		echo ""
		fun_bar 'service squid restart' 'service squid3 restart'
		echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY ADDED!"
		sleep 3
		fun_squid
	}

	rempt_sqd() {
		print_header
		echo -e "${RED}${CROSS_MARK} ${WHITE}REMOVE PORT FROM SQUID${RESET}"
		echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS IN USE: ${GREEN}$sqdp\n"
		if [[ -f "/etc/squid/squid.conf" ]]; then
			var_sqd="/etc/squid/squid.conf"
		elif [[ -f "/etc/squid3/squid.conf" ]]; then
			var_sqd="/etc/squid3/squid.conf"
		else
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}SQUID IS NOT INSTALLED!${RESET}"
			echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
			sleep 2
			fun_squid
		fi
		echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO REMOVE ${YELLOW}? ${GOLD}"
		read pt
		[[ -z "$pt" ]] && {
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid port!"
			sleep 2
			fun_conexao
		}
		if grep -E "$pt" $var_sqd >/dev/null 2>&1; then
			echo -e "\n${GREEN}${GEAR} ${WHITE}REMOVING SQUID PORT!"
			echo ""
			sed -i "/http_port $pt/d" $var_sqd
			fun_bar 'sleep 3'
			echo -e "\n${GREEN}${GEAR} ${WHITE}RESTARTING SQUID!"
			echo ""
			fun_bar 'service squid restart' 'service squid3 restart'
			echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY REMOVED!"
			sleep 3.5s
			fun_squid
		else
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}PORT ${GREEN}$pt ${RED}NOT FOUND!"
			sleep 3.5s
			fun_squid
		fi
	}

	fun_squid() {
		[[ "$(netstat -nplt | grep -c 'squid')" = "0" ]] && inst_sqd
		print_header
		echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE SQUID PROXY${RESET}"
		[[ "$(netstat -nplt | grep -c 'squid')" != "0" ]] && {
			sqdp=$(netstat -nplt | grep 'squid' | awk -F ":" {'print $4'} | xargs)
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS: ${GREEN}$sqdp"
			VarSqdOn="REMOVE SQUID PROXY"
		} || {
			VarSqdOn="INSTALL SQUID PROXY"
		}
		echo ""
		echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}$VarSqdOn            ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}ADD PORT                     ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}REMOVE PORT                  ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
		echo ""
		echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
		read x
		case $x in
		1 | 01)
			inst_sqd
			;;
		2 | 02)
			addpt_sqd
			;;
		3 | 03)
			rempt_sqd
			;;
		0 | 00)
			echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
			sleep 1
			fun_conexao
			;;
		*)
			echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option...${RESET}"
			sleep 2
			fun_conexao
			;;
		esac
	}

	fun_drop() {
		if netstat -nltp | grep 'dropbear' 1>/dev/null 2>/dev/null; then
			print_header
			[[ $(netstat -nltp | grep -c 'dropbear') != '0' ]] && dpbr=$(netstat -nplt | grep 'dropbear' | awk -F ":" {'print $4'} | xargs) || sqdp="${RED}UNAVAILABLE"
			if ps x | grep "limiter" | grep -v grep 1>/dev/null 2>/dev/null; then
				stats="${GREEN}${CHECK_MARK}"
			else
				stats="${RED}${CROSS_MARK}"
			fi
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE DROPBEAR${RESET}"
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS: ${GREEN}$dpbr"
			echo ""
			echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}DROPBEAR LIMITER $stats      ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}CHANGE DROPBEAR PORT         ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}REMOVE DROPBEAR              ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
			read resposta
			if [[ "$resposta" = '1' ]]; then
				if ps x | grep "limiter" | grep -v grep 1>/dev/null 2>/dev/null; then
					echo -e "${RED}${GEAR} ${WHITE}Stopping the limiter...${RESET}"
					echo ""
					fun_stplimiter() {
						pidlimiter=$(ps x | grep "limiter" | awk -F "pts" {'print $1'})
						kill -9 $pidlimiter
						screen -wipe
					}
					fun_bar 'fun_stplimiter' 'sleep 2'
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}LIMIT DISABLED${RESET}"
					sleep 3
					fun_drop
				else
					echo -e "\n${GREEN}${GEAR} ${WHITE}Starting the limiter...${RESET}"
					echo ""
					fun_bar 'screen -d -m -t limiter droplimiter' 'sleep 3'
					echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}LIMITER ENABLED${RESET}"
					sleep 3
					fun_drop
				fi
			elif [[ "$resposta" = '2' ]]; then
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read pt
				echo ""
				verif_ptrs $pt
				var1=$(grep 'DROPBEAR_PORT=' /etc/default/dropbear | cut -d'=' -f2)
				echo -e "${GREEN}${GEAR} ${WHITE}CHANGING DROPBEAR PORT!"
				sed -i "s/\b$var1\b/$pt/g" /etc/default/dropbear >/dev/null 2>&1
				echo ""
				fun_bar 'sleep 2'
				echo -e "\n${GREEN}${GEAR} ${WHITE}RESTARTING DROPBEAR!"
				echo ""
				fun_bar 'service dropbear restart' '/etc/init.d/dropbear restart'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY CHANGED!"
				sleep 3
				fun_conexao
			elif [[ "$resposta" = '3' ]]; then
				echo -e "\n${RED}${GEAR} ${WHITE}REMOVING DROPBEAR!${RESET}"
				echo ""
				fun_dropunistall() {
					service dropbear stop && /etc/init.d/dropbear stop
					apt-get autoremove dropbear -y
					apt-get remove dropbear-run -y
					apt-get remove dropbear -y
					apt-get purge dropbear -y
					rm -rf /etc/default/dropbear
				}
				fun_bar 'fun_dropunistall'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}DROPBEAR SUCCESSFULLY REMOVED!${RESET}"
				sleep 3
				fun_conexao
			elif [[ "$resposta" = '0' ]]; then
				echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 2
				fun_conexao
			else
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid option...${RESET}"
				sleep 2
				fun_conexao
			fi
		else
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}DROPBEAR INSTALLER${RESET}"
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}YOU ARE ABOUT TO INSTALL DROPBEAR!${RESET}\n"
			echo -ne "${GREEN}${ARROW} ${WHITE}DO YOU WISH TO CONTINUE ${RED}? ${YELLOW}[s/n]:${GOLD} "
			read resposta
			[[ "$resposta" = 's' ]] && {
				echo -e "\n${YELLOW}${DIAMOND} ${WHITE}DEFINE A PORT FOR DROPBEAR!${RESET}\n"
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 3
					fun_conexao
				}
				verif_ptrs $porta
				echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING DROPBEAR!${RESET}"
				echo ""
				fun_instdrop() {
					apt-get update -y
					apt-get install dropbear -y
				}
				fun_bar 'fun_instdrop'
				fun_ports() {
					sed -i 's/NO_START=1/NO_START=0/g' /etc/default/dropbear >/dev/null 2>&1
					sed -i "s/DROPBEAR_PORT=22/DROPBEAR_PORT=$porta/g" /etc/default/dropbear >/dev/null 2>&1
					sed -i 's/DROPBEAR_EXTRA_ARGS=/DROPBEAR_EXTRA_ARGS="-p 110"/g' /etc/default/dropbear >/dev/null 2>&1
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}CONFIGURING DROPBEAR PORT!${RESET}"
				echo ""
				fun_bar 'fun_ports'
				grep -v "^PasswordAuthentication yes" /etc/ssh/sshd_config >/tmp/passlogin && mv /tmp/passlogin /etc/ssh/sshd_config
				echo "PasswordAuthentication yes" >>/etc/ssh/sshd_config
				grep -v "^PermitTunnel yes" /etc/ssh/sshd_config >/tmp/ssh && mv /tmp/ssh /etc/ssh/sshd_config
				echo "PermitTunnel yes" >>/etc/ssh/sshd_config
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}FINISHING INSTALLATION!${RESET}"
				echo ""
				fun_ondrop() {
					service dropbear start
					/etc/init.d/dropbear restart
				}
				fun_bar 'fun_ondrop' 'sleep 1'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}INSTALLATION COMPLETED ${YELLOW}PORT: ${GOLD}$porta${RESET}"
				[[ $(grep -c "/bin/false" /etc/shells) = '0' ]] && echo "/bin/false" >>/etc/shells
				sleep 2
				fun_conexao
			} || {
				echo""
				echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 3
				fun_conexao
			}
		fi
	}

    fun_chisel() {
		print_header
		echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE CHISEL${RESET}"
		echo ""
		echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}ACTIVATE CHISEL              ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}RESET CHISEL                 ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
		echo ""
		echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
		read resposta
		if [[ "$resposta" = '1' ]]; then
			if netstat -nltp | grep 'docker' 1>/dev/null 2>/dev/null; then
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}DISABLE CHISEL${RESET}"
				echo ""
				fun_chiseloff() {
					docker stop chisel
                    docker rm chisel
					docker.io stop chisel
                    docker.io rm chisel
				}
				echo -e "${RED}${GEAR} ${WHITE}DISABLING CHISEL${RESET}"
				echo ""
				fun_bar 'fun_chiseloff'
				echo ""
				echo -e "${RED}${CHECK_MARK} ${WHITE}CHISEL SUCCESSFULLY DISABLED!${RESET}"
				sleep 3
				fun_chisel
			else
                fun_installdocker() {
                    _pacotes=("docker" "docker.io")
                    for _prog in ${_pacotes[@]}; do
                    apt install $_prog -y
                    done
                }
                echo -e "\n${YELLOW}BE AWARE THAT THIS METHOD IS UNSTABLE\nMAY OR MAY NOT WORK ON YOUR MACHINE\nBE AWARE OF THE RISKS!${RESET}\n"
                echo -ne "${GREEN}${ARROW} ${WHITE}WISH TO CONTINUE INSTALLATION ${YELLOW}[s/n]:${GOLD} "
                read resp
                [[ "$resp" != @(s|sim|S|SIM) ]] && {
                    echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
                    sleep 2
                    conexao
                }
                echo -e "\n${GREEN}${GEAR} ${WHITE}Supported Ubuntu 16+${RESET}"
                echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING CHISEL!${RESET}"
				echo ""
				fun_bar 'fun_installdocker'
				print_header
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}CHISEL CONFIGURATION${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 3
					fun_chisel
				}
				verif_ptrs $porta
                echo -ne "${GREEN}${ARROW} ${WHITE}Username: ${GOLD}";read username
                [[ -z $username ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Empty or invalid username!${RESET}\n"
                    fun_chisel
                }
                [[ ${username} != ?(+|-)+([a-zA-Z0-9]) ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid username! No spaces or special characters!${RESET}\n"
                    fun_chisel
                }
                sizemin=$(echo ${#username})
                [[ $sizemin -lt 2 ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Username too short! Use at least 2 characters!${RESET}\n"
                    fun_chisel
                }
                sizemax=$(echo ${#username})
                [[ $sizemax -gt 10 ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Username too long! Maximum 10 characters!${RESET}\n"
                    fun_chisel
                }
                echo -ne "${GREEN}${ARROW} ${WHITE}Password: ${GOLD}";read password
                [[ -z $password ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Empty or invalid password!${RESET}\n"
                    fun_chisel 
                }
                sizepass=$(echo ${#password})
                [[ $sizepass -lt 4 ]] && {
                    echo -e "\n${RED}${CROSS_MARK} ${WHITE}Password too short! Use at least 4 characters!${RESET}\n"
                    fun_chisel        
                }
                echo -e "\n${GREEN}${GEAR} ${WHITE}CONFIGURING CHISEL!${RESET}"
				echo ""
                fun_inichisel() {
                    docker run --name chisel -p $porta:$porta -d --restart always jpillora/chisel server -p $porta --socks5 --key supersecret --auth "$username:$password"
                    docker.io run --name chisel -p $porta:$porta -d --restart always jpillora/chisel server -p $porta --socks5 --key supersecret --auth "$username:$password"
                }
                fun_bar 'fun_inichisel'
                echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}CHISEL SUCCESSFULLY INSTALLED! ${YELLOW}PORT: ${GOLD}${porta}${RESET}"
				sleep 3
				fun_chisel
            fi
        elif [[ "$resposta" = '2' ]]; then
            echo -e "\n${GREEN}${GEAR} ${WHITE}RESTARTING CHISEL!${RESET}"
			echo ""
            fun_attchisel() {
                docker restart chisel
                docker.io restart chisel
            }
            fun_bar 'fun_attchisel'
            echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}CHISEL RESTARTED SUCCESSFULLY!${RESET}"
            sleep 1
            fun_chisel
        elif [[ "$resposta" = '0' ]]; then
			echo ""
			echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
			sleep 1
			fun_conexao
		else
			echo ""
			echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
			sleep 1
			fun_socks
		fi
    }

	inst_ssl() {
		if netstat -nltp | grep 'stunnel4' 1>/dev/null 2>/dev/null; then
			[[ $(netstat -nltp | grep 'stunnel4' | wc -l) != '0' ]] && sslt=$(netstat -nplt | grep stunnel4 | awk {'print $4'} | awk -F ":" {'print $2'} | xargs) || sslt="${RED}UNAVAILABLE"
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE SSL TUNNEL${RESET}"
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS: ${GREEN}$sslt"
			echo ""
			echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}CHANGE SSL TUNNEL PORT       ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}REMOVE SSL TUNNEL            ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
			read resposta
			echo ""
			[[ "$resposta" = '1' ]] && {
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				echo ""
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 2
					fun_conexao
				}
				verif_ptrs $porta
				echo -e "${GREEN}${GEAR} ${WHITE}CHANGING SSL TUNNEL PORT!"
				var2=$(grep 'accept' /etc/stunnel/stunnel.conf | awk '{print $NF}')
				sed -i "s/\b$var2\b/$porta/g" /etc/stunnel/stunnel.conf >/dev/null 2>&1
				echo ""
				fun_bar 'sleep 2'
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}RESTARTING SSL TUNNEL!\n"
				fun_bar 'service stunnel4 restart' '/etc/init.d/stunnel4 restart'
				echo ""
				netstat -nltp | grep 'stunnel4' >/dev/null && echo -e "${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY CHANGED!" || echo -e "${RED}${CROSS_MARK} ${WHITE}UNEXPECTED ERROR!"
				sleep 3.5s
				fun_conexao
			}
			[[ "$resposta" = '2' ]] && {
				echo -e "${RED}${GEAR} ${WHITE}REMOVING SSL TUNNEL!${RESET}"
				del_ssl() {
					service stunnel4 stop
					apt-get remove stunnel4 -y
					apt-get autoremove stunnel4 -y
					apt-get purge stunnel4 -y
					rm -rf /etc/stunnel/stunnel.conf
					rm -rf /etc/default/stunnel4
					rm -rf /etc/stunnel/stunnel.pem
				}
				echo ""
				fun_bar 'del_ssl'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}SSL TUNNEL SUCCESSFULLY REMOVED!${RESET}"
				sleep 3
				fun_conexao
			} || {
				echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 3
				fun_conexao
			}
		else
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}INSTALL SSL TUNNEL${RESET}"
			echo ""
			echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}SSL TUNNEL STANDARD          ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}SSL TUNNEL WEBSOCKET         ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
			read resposta
			echo ""
            if [[ "$resposta" = '1' ]]; then
                portssl='22'
            elif [[ "$resposta" = '2' ]]; then     
                portssl='80'
            elif [[ "$resposta" = '0' ]]; then
				echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 3
				fun_conexao
            else
			echo ""
			echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
			sleep 1
			inst_ssl
		fi
            print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}SSL TUNNEL INSTALLER${RESET}"
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}YOU ARE ABOUT TO INSTALL SSL TUNNEL!${RESET}"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}DO YOU WISH TO CONTINUE ${RED}? ${YELLOW}[s/n]:${GOLD} "
			read resposta
			[[ "$resposta" = 's' ]] && {
				echo -e "\n${YELLOW}${DIAMOND} ${WHITE}DEFINE A PORT FOR SSL TUNNEL!${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
                read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 3
					fun_conexao
				}
				verif_ptrs $porta
				echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING SSL TUNNEL!${RESET}"
				echo ""
				fun_bar 'apt-get update -y' 'apt-get install stunnel4 -y'
				echo -e "\n${GREEN}${GEAR} ${WHITE}CONFIGURING SSL TUNNEL!${RESET}"
				echo ""
				ssl_conf() {
					echo -e "cert = /etc/stunnel/stunnel.pem\nclient = no\nsocket = a:SO_REUSEADDR=1\nsocket = l:TCP_NODELAY=1\nsocket = r:TCP_NODELAY=1\n\n[stunnel]\nconnect = 127.0.0.1:$portssl\naccept = ${porta}" >/etc/stunnel/stunnel.conf
				}
				fun_bar 'ssl_conf'
				echo -e "\n${GREEN}${GEAR} ${WHITE}CREATING CERTIFICATE!${RESET}"
				echo ""
				ssl_certif() {
					sed -i 's/ENABLED=0/ENABLED=1/g' /etc/default/stunnel4
					cd /etc/stunnel && wget https://raw.githubusercontent.com/januda-ui/DRAGON-VPS-MANAGER/main/Sistema/script/stunnel.pem && cd $HOME
				}
				fun_bar 'ssl_certif'
				echo -e "\n${GREEN}${GEAR} ${WHITE}STARTING SSL TUNNEL!${RESET}"
				echo ""
				fun_finssl() {
					service stunnel4 restart
					service ssh restart
					/etc/init.d/stunnel4 restart
				}
				fun_bar 'fun_finssl' 'service stunnel4 restart'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SSL TUNNEL SUCCESSFULLY INSTALLED! ${YELLOW}PORT: ${GOLD}$porta${RESET}"
				sleep 3
				fun_conexao
			} || {
				echo -e "\n${RED}${ARROW} ${WHITE}Returning...${RESET}"
				sleep 2
				fun_conexao
			}
		fi
	}

	fun_openvpn() {
		if readlink /proc/$$/exe | grep -qs "dash"; then
			echo "This script needs to be run with bash, not sh"
			exit 1
		fi
		[[ "$EUID" -ne 0 ]] && {
			print_header
			echo "run as root"
			exit 2
		fi
		[[ ! -e /dev/net/tun ]] && {
			echo -e "${RED}${CROSS_MARK} ${WHITE}TUN TAP NOT AVAILABLE${RESET}"
			sleep 2
			exit 3
		fi
		if grep -qs "CentOS release 5" "/etc/redhat-release"; then
			echo "CentOS 5 is too old and not supported"
			exit 4
		fi
		if [[ -e /etc/debian_version ]]; then
			OS=debian
			GROUPNAME=nogroup
			RCLOCAL='/etc/rc.local'
		elif [[ -e /etc/centos-release || -e /etc/redhat-release ]]; then
			OS=centos
			GROUPNAME=nobody
			RCLOCAL='/etc/rc.d/rc.local'
		else
			echo -e "SYSTEM NOT SUPPORTED"
			exit 5
		fi
		newclient() {
			# generate client.ovpn
			cp /etc/openvpn/client-common.txt ~/$1.ovpn
			echo "<ca>" >>~/$1.ovpn
			cat /etc/openvpn/easy-rsa/pki/ca.crt >>~/$1.ovpn
			echo "</ca>" >>~/$1.ovpn
			echo "<cert>" >>~/$1.ovpn
			cat /etc/openvpn/easy-rsa/pki/issued/$1.crt >>~/$1.ovpn
			echo "</cert>" >>~/$1.ovpn
			echo "<key>" >>~/$1.ovpn
			cat /etc/openvpn/easy-rsa/pki/private/$1.key >>~/$1.ovpn
			echo "</key>" >>~/$1.ovpn
			echo "<tls-auth>" >>~/$1.ovpn
			cat /etc/openvpn/ta.key >>~/$1.ovpn
			echo "</tls-auth>" >>~/$1.ovpn
		}
		IP1=$(ip addr | grep 'inet' | grep -v inet6 | grep -vE '127\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | grep -o -E '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | head -1)
		IP2=$(wget -4qO- "http://whatismyip.akamai.com/")
		[[ "$IP1" = "" ]] && {
			IP1=$(hostname -I | cut -d' ' -f1)
		}
		[[ "$IP1" != "$IP2" ]] && {
			IP="$IP1"
		} || {
			IP="$IP2"
		}
		[[ $(netstat -nplt | grep -wc 'openvpn') != '0' ]] && {
			while :; do
				print_header

				opnp=$(cat /etc/openvpn/server.conf | grep "port" | awk {'print $2'})
				[[ -d /var/www/html/openvpn ]] && {
					ovpnweb="${GREEN}${CHECK_MARK}"
				} || {
					ovpnweb="${RED}${CROSS_MARK}"
				}
				if grep "duplicate-cn" /etc/openvpn/server.conf >/dev/null; then
					mult="${GREEN}${CHECK_MARK}"
				else
					mult="${RED}${CROSS_MARK}"
				fi
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE OPENVPN${RESET}"
				echo ""
				echo -e "${YELLOW}${DIAMOND} ${WHITE}PORT: ${GREEN}$opnp"
				echo ""
				echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}CHANGE PORT                  ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}REMOVE OPENVPN               ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}OVPN VIA LINK $ovpnweb         ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}4${RESET} ${ARROW} ${WHITE}MULTILOGIN OVPN $mult       ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}5${RESET} ${ARROW} ${WHITE}CHANGE HOST DNS              ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
				read option
				case $option in
				1)
					print_header
					echo -e "${NEON_BLUE}${GEAR} ${WHITE}CHANGE OPENVPN PORT${RESET}"
					echo ""
					echo -e "${YELLOW}${DIAMOND} ${WHITE}PORT IN USE: ${GREEN}$opnp"
					echo ""
					echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
					read porta
					[[ -z "$porta" ]] && {
						echo ""
						echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
						sleep 3
						fun_conexao
					}
					verif_ptrs
					echo ""
					echo -e "${GREEN}${GEAR} ${WHITE}CHANGING OPENVPN PORT!${RESET}"
					echo ""
					fun_opn() {
						var_ptovpn=$(sed -n '1 p' /etc/openvpn/server.conf)
						sed -i "s/\b$var_ptovpn\b/port $porta/g" /etc/openvpn/server.conf
						sleep 1
						var_ptovpn2=$(sed -n '7 p' /etc/openvpn/client-common.txt | awk {'print $NF'})
						sed -i "s/\b$var_ptovpn2/\b$porta/g" /etc/openvpn/client-common.txt
						sleep 1
						service openvpn restart
					}
					fun_bar 'fun_opn'
					echo ""
					echo -e "${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY CHANGED!${RESET}"
					sleep 2
					fun_conexao
					;;
				2)
					echo ""
					echo -ne "${GREEN}${ARROW} ${WHITE}WANT TO REMOVE OPENVPN ${RED}? ${YELLOW}[s/n]:${GOLD} "
					read REMOVE
					[[ "$REMOVE" = 's' ]] && {
						rmv_open() {
							PORT=$(grep '^port ' /etc/openvpn/server.conf | cut -d " " -f 2)
							PROTOCOL=$(grep '^proto ' /etc/openvpn/server.conf | cut -d " " -f 2)
							IP=$(grep 'iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -j SNAT --to ' $RCLOCAL | cut -d " " -f 11)
							if pgrep firewalld; then
								firewall-cmd --zone=public --remove-port=$PORT/$PROTOCOL
								firewall-cmd --zone=trusted --remove-source=10.8.0.0/24
								firewall-cmd --permanent --zone=public --remove-port=$PORT/$PROTOCOL
								firewall-cmd --permanent --zone=trusted --remove-source=10.8.0.0/24
							fi
							if iptables -L -n | grep -qE 'REJECT|DROP|ACCEPT'; then
								iptables -D INPUT -p $PROTOCOL --dport $PORT -j ACCEPT
								iptables -D FORWARD -s 10.8.0.0/24 -j ACCEPT
								iptables -D FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
								sed -i "/iptables -I INPUT -p $PROTOCOL --dport $PORT -j ACCEPT/d" $RCLOCAL
								sed -i "/iptables -I FORWARD -s 10.8.0.0\/24 -j ACCEPT/d" $RCLOCAL
								sed -i "/iptables -I FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT/d" $RCLOCAL
							fi
							iptables -t nat -D POSTROUTING -s 10.8.0.0/24 -j SNAT --to $IP
							sed -i '/iptables -t nat -A POSTROUTING -s 10.8.0.0\/24 -j SNAT --to /d' $RCLOCAL
							if hash sestatus 2>/dev/null; then
								if sestatus | grep "Current mode" | grep -qs "enforcing"; then
									if [[ "$PORT" != '1194' || "$PROTOCOL" = 'tcp' ]]; then
										semanage port -d -t openvpn_port_t -p $PROTOCOL $PORT
									fi
								fi
							fi
							[[ "$OS" = 'debian' ]] && {
								apt-get remove --purge -y openvpn openvpn-blacklist
								apt-get autoremove openvpn -y
								apt-get autoremove -y
							} || {
								yum remove openvpn -y
							}
							rm -rf /etc/openvpn
							rm -rf /usr/share/doc/openvpn*
						}
						echo ""
						echo -e "${RED}${GEAR} ${WHITE}REMOVING OPENVPN!${RESET}"
						echo ""
						fun_bar 'rmv_open'
						echo ""
						echo -e "${GREEN}${CHECK_MARK} ${WHITE}OPENVPN SUCCESSFULLY REMOVED!${RESET}"
						sleep 2
						fun_conexao
					} || {
						echo ""
						echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
						sleep 2
						fun_conexao
					}
					;;
				3)
					[[ -d /var/www/html/openvpn ]] && {
						fun_spcr() {
							apt-get remove apache2 -y
							apt-get autoremove -y
							rm -rf /var/www/html/openvpn
						}
						function aguarde() {
							helice() {
								fun_spcr >/dev/null 2>&1 &
								tput civis
								while [ -d /proc/$! ]; do
									for i in / - \\ \|; do
										sleep .1
										echo -ne "\e[1D$i"
									done
								done
								tput cnorm
							}
							echo -ne "${RED}${GEAR} ${WHITE}DISABLING${RESET}"
							helice
							echo -e "\e[1DOk"
						}
						aguarde
						sleep 2
						fun_openvpn
					} || {
						fun_apchon() {
							apt-get install apache2 zip -y
							sed -i "s/Listen 80/Listen 81/g" /etc/apache2/ports.conf
							service apache2 restart
							[[ ! -d /var/www/html ]] && {
								mkdir /var/www/html
							}
							[[ ! -d /var/www/html/openvpn ]] && {
								mkdir /var/www/html/openvpn
							}
							touch /var/www/html/openvpn/index.html
							chmod -R 755 /var/www
							/etc/init.d/apache2 restart
						}
						function aguarde2() {
							helice() {
								fun_apchon >/dev/null 2>&1 &
								tput civis
								while [ -d /proc/$! ]; do
									for i in / - \\ \|; do
										sleep .1
										echo -ne "\e[1D$i"
									done
								done
								tput cnorm
							}
							echo -ne "${GREEN}${GEAR} ${WHITE}ACTIVATING${RESET}"
							helice
							echo -e "\e[1DOk"
						}
						aguarde2
						fun_openvpn
					}
					;;
				4)
					if grep "duplicate-cn" /etc/openvpn/server.conf >/dev/null; then
						fun_multon() {
							sed -i '/duplicate-cn/d' /etc/openvpn/server.conf
							sleep 1.5s
							service openvpn restart >/dev/null
							sleep 2
						}
						fun_spinmult() {
							helice() {
								fun_multon >/dev/null 2>&1 &
								tput civis
								while [ -d /proc/$! ]; do
									for i in / - \\ \|; do
										sleep .1
										echo -ne "\e[1D$i"
									done
								done
								tput cnorm
							}
							echo ""
							echo -ne "${RED}${GEAR} ${WHITE}MULTILOGIN BLOCK${RESET}"
							helice
							echo -e "\e[1DOk"
						}
						fun_spinmult
						sleep 1
						fun_openvpn
					else
						fun_multoff() {
							grep -v "^duplicate-cn" /etc/openvpn/server.conf >/tmp/tmpass && mv /tmp/tmpass /etc/openvpn/server.conf
							echo "duplicate-cn" >>/etc/openvpn/server.conf
							sleep 1.5s
							service openvpn restart >/dev/null
						}
						fun_spinmult2() {
							helice() {
								fun_multoff >/dev/null 2>&1 &
								tput civis
								while [ -d /proc/$! ]; do
									for i in / - \\ \|; do
										sleep .1
										echo -ne "\e[1D$i"
									done
								done
								tput cnorm
							}
							echo ""
							echo -ne "${GREEN}${GEAR} ${WHITE}ALLOWING MULTILOGIN${RESET}"
							helice
							echo -e "\e[1DOk"
						}
						fun_spinmult2
						sleep 1
						fun_openvpn
					fi
					;;
				5)
					print_header
					echo -e "${NEON_BLUE}${GEAR} ${WHITE}CHANGE DNS HOST${RESET}"
					echo ""
					echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
					echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}ADD HOST DNS                 ${CYAN}‚îÇ${RESET}"
					echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}REMOVE HOST DNS              ${CYAN}‚îÇ${RESET}"
					echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}EDIT MANUALLY                ${CYAN}‚îÇ${RESET}"
					echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
					echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
					echo ""
					echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
					read resp
					[[ -z "$resp" ]] && {
						echo ""
						echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!"
						sleep 3
						fun_openvpn
					}
					if [[ "$resp" = '1' ]]; then
						print_header
						echo -e "${NEON_BLUE}${GEAR} ${WHITE}Add DNS Host${RESET}"
						echo ""
						echo -e "${YELLOW}${DIAMOND} ${WHITE}Current hosts:${RESET} "
						echo ""
						i=0
						for _host in $(grep -w "127.0.0.1" /etc/hosts | grep -v "localhost" | cut -d' ' -f2); do
							echo -e "${GREEN}$_host"
						done
						echo ""
						echo -ne "${GREEN}${ARROW} ${WHITE}Enter host to add: ${GOLD}"
						read host
						if [[ -z $host ]]; then
							echo ""
							echo -e "${RED}${CROSS_MARK} ${WHITE}Empty or invalid field!${RESET}"
							sleep 2
							fun_openvpn
						fi
						if [[ "$(grep -w "$host" /etc/hosts | wc -l)" -gt "0" ]]; then
							echo -e "${RED}${CROSS_MARK} ${WHITE}This host is already added!${RESET}"
							sleep 2
							fun_openvpn
						fi
						sed -i "3i\127.0.0.1 $host" /etc/hosts
						echo ""
						echo -e "${GREEN}${CHECK_MARK} ${WHITE}Host added successfully!${RESET}"
						sleep 2
						fun_openvpn
					elif [[ "$resp" = '2' ]]; then
						print_header
						echo -e "${RED}${CROSS_MARK} ${WHITE}DNS Host Remover${RESET}"
						echo ""
						echo -e "${YELLOW}${DIAMOND} ${WHITE}Current hosts:${RESET} "
						echo ""
						i=0
						for _host in $(grep -w "127.0.0.1" /etc/hosts | grep -v "localhost" | cut -d' ' -f2); do
							i=$(expr $i + 1)
							oP+=$i
							[[ $i == [1-9] ]] && oP+=" 0$i" && i=0$i
							oP+=":$_host\n"
							echo -e "${YELLOW}[$i] ${WHITE}- ${GREEN}$_host${RESET}"
						done
						echo ""
						echo -ne "${GREEN}${ARROW} ${WHITE}Select host to remove [${YELLOW}1${WHITE}-${YELLOW}$i${WHITE}]: ${GOLD}"
						read option
						if [[ -z $option ]]; then
							echo ""
							echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
							sleep 2
							fun_openvpn
						fi
						host=$(echo -e "$oP" | grep -E "\b$option\b" | cut -d: -f2)
						hst=$(grep -v "127.0.0.1 $host" /etc/hosts)
						echo "$hst" >/etc/hosts
						echo ""
						echo -e "${GREEN}${CHECK_MARK} ${WHITE}Host removed successfully!${RESET}"
						sleep 2
						fun_openvpn
					elif [[ "$resp" = '3' ]]; then
						echo -e "\n${GREEN}${GEAR} ${WHITE}CHANGING FILE ${GOLD}/etc/hosts${RESET}"
						echo -e "\n${RED}${DIAMOND} ${WHITE}ATTENTION!${RESET}"
						echo -e "\n${YELLOW}${DIAMOND} ${WHITE}TO SAVE USE KEYS ${GREEN}ctrl x y${RESET}"
						sleep 4
						nano /etc/hosts
						echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SUCCESSFULLY CHANGED!${RESET}"
						sleep 3
						fun_openvpn
					elif [[ "$resp" = '0' ]]; then
						echo ""
						echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
						sleep 2
						fun_conexao
					else
						echo ""
						echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
						sleep 2
						fun_openvpn
					fi
					;;
				0)
					fun_conexao
					;;
				*)
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
					sleep 2
					fun_openvpn
					;;
				esac
			done
		} || {
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}OPENVPN INSTALLER${RESET}"
			echo ""
			echo -e "${YELLOW}${DIAMOND} ${WHITE}ANSWER THE QUESTIONS TO START INSTALLATION"
			echo ""
			echo -ne "${GREEN}${ARROW} ${WHITE}CONFIRM YOUR IP: ${GOLD}"
			read -e -i $IP IP
			[[ -z "$IP" ]] && {
				echo ""
				echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid IP!"
				sleep 3
				fun_conexao
			}
			echo ""
			read -p "$(echo -e "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE? ${GOLD}")" -e -i 1194 porta
			[[ -z "$porta" ]] && {
				echo ""
				echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
				sleep 2
				fun_conexao
			}
			echo ""
			echo -e "${YELLOW}${GEAR} ${WHITE}VERIFYING PORT..."
			verif_ptrs $porta
			echo ""
			echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}System                       ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}Google ${GREEN}(Recommended)${WHITE}       ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}OpenDNS                      ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}4${RESET} ${ARROW} ${WHITE}Cloudflare                   ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}5${RESET} ${ARROW} ${WHITE}Hurricane Electric           ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}6${RESET} ${ARROW} ${WHITE}Verisign                     ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}7${RESET} ${ARROW} ${WHITE}DNS Performance              ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo ""
			read -p "$(echo -e "${GREEN}${ARROW} ${WHITE}WHICH DNS TO USE? ${GOLD}")" -e -i 2 DNS
			echo ""
			echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}UDP                          ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}TCP ${GREEN}(Recommended)${WHITE}        ${CYAN}‚îÇ${RESET}"
			echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo ""
			read -p "$(echo -e "${GREEN}${ARROW} ${WHITE}WHICH PROTOCOL FOR OPENVPN? ${GOLD}")" -e -i 2 resp
			if [[ "$resp" = '1' ]]; then
				PROTOCOL=udp
			elif [[ "$resp" = '2' ]]; then
				PROTOCOL=tcp
			else
				PROTOCOL=tcp
			fi
			echo ""
			[[ "$OS" = 'debian' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}UPDATING SYSTEM"
				echo ""
				fun_attos() {
					apt-get update-y
				}
				fun_bar 'fun_attos'
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}INSTALLING DEPENDENCIES"
				echo ""
				fun_instdep() {
					apt-get install openvpn iptables openssl ca-certificates -y
					apt-get install zip -y
				}
				fun_bar 'fun_instdep'
			} || {
				fun_bar 'yum install epel-release -y'
				fun_bar 'yum install openvpn iptables openssl wget ca-certificates -y'
			}
			[[ -d /etc/openvpn/easy-rsa/ ]] && {
				rm -rf /etc/openvpn/easy-rsa/
			}
			# Acquiring easy-rsa
			echo ""
			fun_dep() {
				wget -O ~/EasyRSA-3.0.1.tgz "https://github.com/januda-ui/DRAGON-VPS-MANAGER/raw/main/Install/EasyRSA-3.0.1.tgz"
				[[ ! -e $HOME/EasyRSA-3.0.1.tgz ]] && {
					wget -O ~/EasyRSA-3.0.1.tgz "http://sshplus.xyz/script/EasyRSA-3.0.1.tgz"
				}
				tar xzf ~/EasyRSA-3.0.1.tgz -C ~/
				mv ~/EasyRSA-3.0.1/ /etc/openvpn/
				mv /etc/openvpn/EasyRSA-3.0.1/ /etc/openvpn/easy-rsa/
				chown -R root:root /etc/openvpn/easy-rsa/
				rm -rf ~/EasyRSA-3.0.1.tgz
				cd /etc/openvpn/easy-rsa/
				./easyrsa init-pki
				./easyrsa --batch build-ca nopass
				./easyrsa gen-dh
				./easyrsa build-server-full server nopass
				./easyrsa build-client-full VPSMANAGER nopass
				./easyrsa gen-crl
				cp pki/ca.crt pki/private/ca.key pki/dh.pem pki/issued/server.crt pki/private/server.key /etc/openvpn/easy-rsa/pki/crl.pem /etc/openvpn
				chown nobody:$GROUPNAME /etc/openvpn/crl.pem
				openvpn --genkey --secret /etc/openvpn/ta.key
				# Generating server.conf
				echo "port $porta
proto $PROTOCOL
dev tun
sndbuf 0
rcvbuf 0
ca ca.crt
cert server.crt
key server.key
dh dh.pem
tls-auth ta.key 0
topology subnet
server 10.8.0.0 255.255.255.0
ifconfig-pool-persist ipp.txt" >/etc/openvpn/server.conf
				echo 'push "redirect-gateway def1 bypass-dhcp"' >>/etc/openvpn/server.conf
				# DNS
				case $DNS in
				1)
					# Obtain the resolvers from resolv.conf and use them for OpenVPN
					grep -v '#' /etc/resolv.conf | grep 'nameserver' | grep -E -o '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | while read line; do
						echo "push \"dhcp-option DNS $line\"" >>/etc/openvpn/server.conf
					done
					;;
				2)
					echo 'push "dhcp-option DNS 8.8.8.8"' >>/etc/openvpn/server.conf
					echo 'push "dhcp-option DNS 8.8.4.4"' >>/etc/openvpn/server.conf
					;;
				3)
					echo 'push "dhcp-option DNS 208.67.222.222"' >>/etc/openvpn/server.conf
					echo 'push "dhcp-option DNS 208.67.220.220"' >>/etc/openvpn/server.conf
					;;
				4)
					echo 'push "dhcp-option DNS 1.1.1.1"' >>/etc/openvpn/server.conf
					echo 'push "dhcp-option DNS 1.0.0.1"' >>/etc/openvpn/server.conf
					;;
				5)
					echo 'push "dhcp-option DNS 74.82.42.42"' >>/etc/openvpn/server.conf
					;;
				6)
					echo 'push "dhcp-option DNS 64.6.64.6"' >>/etc/openvpn/server.conf
					echo 'push "dhcp-option DNS 64.6.65.6"' >>/etc/openvpn/server.conf
					;;
				7)
					echo 'push "dhcp-option DNS 189.38.95.95"' >>/etc/openvpn/server.conf
					echo 'push "dhcp-option DNS 216.146.36.36"' >>/etc/openvpn/server.conf
					;;
				esac
				echo "keepalive 10 120
float
cipher AES-256-CBC
comp-lzo yes
user nobody
group $GROUPNAME
persist-key
persist-tun
status openvpn-status.log
management localhost 7505
verb 3
crl-verify crl.pem
client-to-client
client-cert-not-required
username-as-common-name
plugin $(find /usr -type f -name 'openvpn-plugin-auth-pam.so') login
duplicate-cn" >>/etc/openvpn/server.conf
				sed -i '/\<net.ipv4.ip_forward\>/c\net.ipv4.ip_forward=1' /etc/sysctl.conf
				if ! grep -q "\<net.ipv4.ip_forward\>" /etc/sysctl.conf; then
					echo 'net.ipv4.ip_forward=1' >>/etc/sysctl.conf
				fi
				echo 1 >/proc/sys/net/ipv4/ip_forward
				if [[ "$OS" = 'debian' && ! -e $RCLOCAL ]]; then
					echo '#!/bin/sh -e
exit 0' >$RCLOCAL
				fi
				chmod +x $RCLOCAL
				iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -j SNAT --to $IP
				sed -i "1 a\iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -j SNAT --to $IP" $RCLOCAL
				if pgrep firewalld; then
					firewall-cmd --zone=public --add-port=$porta/$PROTOCOL
					firewall-cmd --zone=trusted --add-source=10.8.0.0/24
					firewall-cmd --permanent --zone=public --add-port=$porta/$PROTOCOL
					firewall-cmd --permanent --zone=trusted --add-source=10.8.0.0/24
				fi
				if iptables -L -n | grep -qE 'REJECT|DROP'; then
					iptables -I INPUT -p $PROTOCOL --dport $porta -j ACCEPT
					iptables -I FORWARD -s 10.8.0.0/24 -j ACCEPT
					iptables -F
					iptables -I FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
					sed -i "1 a\iptables -I INPUT -p $PROTOCOL --dport $porta -j ACCEPT" $RCLOCAL
					sed -i "1 a\iptables -I FORWARD -s 10.8.0.0/24 -j ACCEPT" $RCLOCAL
					sed -i "1 a\iptables -I FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT" $RCLOCAL
				fi
				if hash sestatus 2>/dev/null; then
					if sestatus | grep "Current mode" | grep -qs "enforcing"; then
						if [[ "$porta" != '1194' || "$PROTOCOL" = 'tcp' ]]; then
							if ! hash semanage 2>/dev/null; then
								yum install policycoreutils-python -y
							fi
							semanage port -a -t openvpn_port_t -p $PROTOCOL $porta
						fi
					fi
				fi
			}
			echo -e "${GREEN}${GEAR} ${WHITE}INSTALLING OPENVPN ${RED}(${YELLOW}MAY TAKE TIME!${RED})"
			echo ""
			fun_bar 'fun_dep > /dev/null 2>&1'
			fun_ropen() {
				[[ "$OS" = 'debian' ]] && {
					if pgrep systemd-journal; then
						systemctl restart openvpn@server.service
					else
						/etc/init.d/openvpn restart
					fi
				} || {
					if pgrep systemd-journal; then
						systemctl restart openvpn@server.service
						systemctl enable openvpn@server.service
					else
						service openvpn restart
						chkconfig openvpn on
					fi
				}
			}
			echo ""
			echo -e "${GREEN}${GEAR} ${WHITE}RESTARTING OPENVPN"
			echo ""
			fun_bar 'fun_ropen'
			IP2=$(wget -4qO- "http://whatismyip.akamai.com/")
			if [[ "$IP" != "$IP2" ]]; then
				IP="$IP2"
			fi
			[[ $(grep -wc 'open.py' /etc/autostart) != '0' ]] && pt_proxy=$(grep -w 'open.py' /etc/autostart| cut -d' ' -f6) || pt_proxy=80
			cat <<-EOF >/etc/openvpn/client-common.txt
				# OVPN_ACCESS_SERVER_PROFILE=[VPSMANAGER]
				client
				dev tun
				proto $PROTOCOL
				sndbuf 0
				rcvbuf 0
				remote /VPSMANAGER? $porta
				#payload "HTTP/1.1 [lf]CONNECT HTTP/1.1[lf][lf]|[lf]."
				http-proxy $IP $pt_proxy
				resolv-retry 5
				nobind
				persist-key
				persist-tun
				remote-cert-tls server
				cipher AES-256-CBC
				comp-lzo yes
				setenv opt block-outside-dns
				key-direction 1
				verb 3
				auth-user-pass
				keepalive 10 120
				float
			EOF
			# generate client.ovpn
			newclient "VPSMANAGER"
			[[ "$(netstat -nplt | grep -wc 'openvpn')" != '0' ]] && echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}OPENVPN SUCCESSFULLY INSTALLED${RESET}" || echo -e "\n${RED}${CROSS_MARK} ${WHITE}ERROR! INSTALLATION CORRUPTED${RESET}"
		}
		sed -i '$ i\echo 1 > /proc/sys/net/ipv4/ip_forward' /etc/rc.local
		sed -i '$ i\echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6' /etc/rc.local
		sed -i '$ i\iptables -A INPUT -p tcp --dport 25 -j DROP' /etc/rc.local
		sed -i '$ i\iptables -A INPUT -p tcp --dport 110 -j DROP' /etc/rc.local
		sed -i '$ i\iptables -A OUTPUT -p tcp --dport 25 -j DROP' /etc/rc.local
		sed -i '$ i\iptables -A OUTPUT -p tcp --dport 110 -j DROP' /etc/rc.local
		sed -i '$ i\iptables -A FORWARD -p tcp --dport 25 -j DROP' /etc/rc.local
		sed -i '$ i\iptables -A FORWARD -p tcp --dport 110 -j DROP' /etc/rc.local
		sleep 3
		fun_conexao
	}

	fun_socks() {
		print_header
		echo -e "${NEON_BLUE}${GEAR} ${WHITE}MANAGE PROXY SOCKS${RESET}"
		echo ""
		[[ $(netstat -nplt | grep -wc 'python') != '0' ]] && {
			sks="${GREEN}ON"
			echo -e "${YELLOW}${DIAMOND} ${WHITE}PORTS: ${GREEN}$(netstat -nplt | grep 'python' | awk {'print $4'} | cut -d: -f2 | xargs)"
		} || {
			sks="${RED}OFF"
		}
		[[ $(screen -list | grep -wc 'proxy') != '0' ]] && var_sks1="${GREEN}${CHECK_MARK}" || var_sks1="${RED}${CROSS_MARK}"
		[[ $(screen -list | grep -wc 'ws') != '0' ]] && var_sks2="${GREEN}${CHECK_MARK}" || var_sks2="${RED}${CROSS_MARK}"
		[[ $(screen -list | grep -wc 'openpy') != '0' ]] && sksop="${GREEN}${CHECK_MARK}" || sksop="${RED}${CROSS_MARK}"
		echo ""
		echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}SOCKS SSH $var_sks1            ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}WEBSOCKET $var_sks2            ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}SOCKS OPENVPN $sksop         ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}4${RESET} ${ARROW} ${WHITE}OPEN PORT                    ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}5${RESET} ${ARROW} ${WHITE}CHANGE SOCKS SSH STATUS      ${CYAN}‚îÇ${RESET}"
        echo -e "${CYAN}‚îÇ ${YELLOW}6${RESET} ${ARROW} ${WHITE}CHANGE WEBSOCKET STATUS      ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}0${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
		echo ""
		echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
		read resposta
		if [[ "$resposta" = '1' ]]; then
			if ps x | grep -w proxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}DISABLE PROXY SOCKS${RESET}"
				echo ""
				fun_socksoff() {
					for pidproxy in $(screen -ls | grep ".proxy" | awk {'print $1'}); do
						screen -r -S "$pidproxy" -X quit
					done
					[[ $(grep -wc "proxy.py" /etc/autostart) != '0' ]] && {
						sed -i '/proxy.py/d' /etc/autostart
					}
					sleep 1
					screen -wipe >/dev/null
				}
				echo -e "${RED}${GEAR} ${WHITE}DISABLING PROXY SOCKS${RESET}"
				echo ""
				fun_bar 'fun_socksoff'
				echo ""
				echo -e "${RED}${CHECK_MARK} ${WHITE}PROXY SOCKS SUCCESSFULLY DISABLED!${RESET}"
				sleep 3
				fun_socks
			else
				print_header
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}ACTIVATE PROXY SOCKS${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 3
					fun_conexao
				}
				verif_ptrs $porta
				fun_inisocks() {
					sleep 1
					screen -dmS proxy python /etc/VPSManager/proxy.py $porta
					[[ $(grep -wc "proxy.py" /etc/autostart) = '0' ]] && {
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'proxy' -X quit;  screen -dmS proxy python /etc/VPSManager/proxy.py $porta; }" >>/etc/autostart
					} || {
						sed -i '/proxy.py/d' /etc/autostart
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'proxy' -X quit;  screen -dmS proxy python /etc/VPSManager/proxy.py $porta; }" >>/etc/autostart
					}
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}STARTING PROXY SOCKS${RESET}"
				echo ""
				fun_bar 'fun_inisocks'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}SOCKS SUCCESSFULLY ACTIVATED${RESET}"
				sleep 3
				fun_socks
			fi
        elif [[ "$resposta" = '2' ]]; then
			if ps x | grep -w wsproxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}DISABLE WEBSOCKET${RESET}"
				echo ""
				fun_wssocksoff() {
					for pidproxy in $(screen -ls | grep ".ws" | awk {'print $1'}); do
						screen -r -S "$pidproxy" -X quit
					done
					[[ $(grep -wc "wsproxy.py" /etc/autostart) != '0' ]] && {
						sed -i '/wsproxy.py/d' /etc/autostart
					}
					sleep 1
					screen -wipe >/dev/null
				}
				echo -e "${RED}${GEAR} ${WHITE}DISABLING WEBSOCKET${RESET}"
				echo ""
				fun_bar 'fun_wssocksoff'
				echo ""
				echo -e "${RED}${CHECK_MARK} ${WHITE}WEBSOCKET SUCCESSFULLY DISABLED!${RESET}"
				sleep 3
				fun_socks
			else
				print_header
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}ACTIVATE WEBSOCKET${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 3
					fun_conexao
				}
				verif_ptrs $porta
				fun_iniwssocks() {
					sleep 1
					screen -dmS ws python /etc/VPSManager/wsproxy.py $porta
					[[ $(grep -wc "wsproxy.py" /etc/autostart) = '0' ]] && {
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'ws' -X quit;  screen -dmS ws python /etc/VPSManager/wsproxy.py $porta; }" >>/etc/autostart
					} || {
						sed -i '/wsproxy.py/d' /etc/autostart
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'ws' -X quit;  screen -dmS ws python /etc/VPSManager/wsproxy.py $porta; }" >>/etc/autostart
					}
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}STARTING WEBSOCKET${RESET}"
				echo ""
				fun_bar 'fun_iniwssocks'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}WEBSOCKET SUCCESSFULLY ACTIVATED${RESET}"
				sleep 3
				fun_socks
			fi
		elif [[ "$resposta" = '3' ]]; then
			if ps x | grep -w open.py | grep -v grep 1>/dev/null 2>/dev/null; then
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}DISABLE SOCKS OPENVPN${RESET}"
				echo ""
				fun_socksopenoff() {
					for pidproxy in $(screen -list | grep -w "openpy" | awk {'print $1'}); do
						screen -r -S "$pidproxy" -X quit
					done
					[[ $(grep -wc "open.py" /etc/autostart) != '0' ]] && {
						sed -i '/open.py/d' /etc/autostart
					}
					sleep 1
					screen -wipe >/dev/null
				}
				echo -e "${RED}${GEAR} ${WHITE}DISABLING SOCKS OPENVPN${RESET}"
				echo ""
				fun_bar 'fun_socksopenoff'
				echo ""
				echo -e "${RED}${CHECK_MARK} ${WHITE}SOCKS SUCCESSFULLY DISABLED!${RESET}"
				sleep 2
				fun_socks
			else
				print_header
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}ACTIVATE SOCKS OPENVPN${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid port!"
					sleep 2
					fun_conexao
				}
				verif_ptrs $porta
				fun_inisocksop() {
					[[ "$(netstat -tlpn | grep 'openvpn' | wc -l)" != '0' ]] && {
						listoldop=$(grep -w 'DEFAULT_HOST =' /etc/VPSManager/open.py | cut -d"'" -f2 | cut -d: -f2)
						listopen=$(netstat -tlpn | grep -w openvpn | grep -v 127.0.0.1 | awk {'print $4'} | cut -d: -f2)
						sed -i "s/$listoldop/$listopen/" /etc/VPSManager/open.py
					}
					sleep 1
					screen -dmS openpy python /etc/VPSManager/open.py $porta
					[[ $(grep -wc "open.py" /etc/autostart) = '0' ]] && {
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'openpy' -X quit;  screen -dmS openpy python /etc/VPSManager/open.py $porta; }" >>/etc/autostart
					} || {
						sed -i '/open.py/d' /etc/autostart
						echo -e "netstat -tlpn | grep -w $porta > /dev/null || {  screen -r -S 'openpy' -X quit;  screen -dmS openpy python /etc/VPSManager/open.py $porta; }" >>/etc/autostart
					}
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}STARTING SOCKS OPENVPN${RESET}"
				echo ""
				fun_bar 'fun_inisocksop'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}SOCKS OPENVPN SUCCESSFULLY ACTIVATED${RESET}"
				sleep 3
				fun_socks
			fi
		elif [[ "$resposta" = '4' ]]; then
			if ps x | grep proxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
				sockspt=$(netstat -nplt | grep 'python' | awk {'print $4'} | cut -d: -f2 | xargs)
				print_header
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}OPEN PROXY SOCKS PORT${RESET}"
				echo ""
				echo -e "${YELLOW}${DIAMOND} ${WHITE}PORT IN USE: ${GREEN}$sockspt"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO USE ${YELLOW}? ${GOLD}"
				read porta
				[[ -z "$porta" ]] && {
					echo ""
					echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid Port!"
					sleep 2
					fun_conexao
				}
				verif_ptrs $porta
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}STARTING PROXY SOCKS ON PORT ${GOLD}$porta${RESET}"
				echo ""
				abrirptsks() {
					sleep 1
					screen -dmS proxy python /etc/VPSManager/proxy.py $porta
					sleep 1
				}
				fun_bar 'abrirptsks'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}PROXY SOCKS SUCCESSFULLY ACTIVATED!${RESET}"
				sleep 2
				fun_socks
			else
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}UNAVAILABLE FUNCTION\n\n${YELLOW}${DIAMOND} ${WHITE}ACTIVATE SOCKS FIRST!${RESET}"
				sleep 2
				fun_socks
			fi
		elif [[ "$resposta" = '5' ]]; then
			if ps x | grep -w proxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
				print_header
				msgsocks=$(cat /etc/VPSManager/proxy.py | grep -E "MSG =" | awk -F = '{print $2}' | cut -d "'" -f 2)
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}CHANGE SOCKS SSH STATUS${RESET}"
				echo ""
				echo -e "${YELLOW}${DIAMOND} ${WHITE}CURRENT STATUS: ${GREEN}$msgsocks"
				echo""
				echo -ne "${GREEN}${ARROW} ${WHITE}INFORM YOUR STATUS: ${GOLD}"
				read msgg
				[[ -z "$msgg" ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid status!"
					sleep 2
					fun_conexao
				}
				[[ ${msgg} != ?(+|-)+([a-zA-Z0-9-. ]) ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}AVOID SPECIAL CHARACTERS${RESET}"
					sleep 2
					fun_socks
				}
				echo -e "\n${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}01${RESET} ${ARROW} ${WHITE}BLUE                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}02${RESET} ${ARROW} ${WHITE}GREEN                       ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}03${RESET} ${ARROW} ${WHITE}RED                         ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}04${RESET} ${ARROW} ${WHITE}YELLOW                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}05${RESET} ${ARROW} ${WHITE}PINK                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}06${RESET} ${ARROW} ${WHITE}CYAN                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}07${RESET} ${ARROW} ${WHITE}ORANGE                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}08${RESET} ${ARROW} ${WHITE}PURPLE                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}09${RESET} ${ARROW} ${WHITE}BLACK                       ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}10${RESET} ${ARROW} ${WHITE}NO COLOR                    ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH COLOR ${YELLOW}? ${GOLD}"
				read sts_cor
				if [[ "$sts_cor" = "1" ]] || [[ "$sts_cor" = "01" ]]; then
					cor_sts='blue'
				elif [[ "$sts_cor" = "2" ]] || [[ "$sts_cor" = "02" ]]; then
					cor_sts='green'
				elif [[ "$sts_cor" = "3" ]] || [[ "$sts_cor" = "03" ]]; then
					cor_sts='red'
				elif [[ "$sts_cor" = "4" ]] || [[ "$sts_cor" = "04" ]]; then
					cor_sts='yellow'
				elif [[ "$sts_cor" = "5" ]] || [[ "$sts_cor" = "05" ]]; then
					cor_sts='#F535AA'
				elif [[ "$sts_cor" = "6" ]] || [[ "$sts_cor" = "06" ]]; then
					cor_sts='cyan'
				elif [[ "$sts_cor" = "7" ]] || [[ "$sts_cor" = "07" ]]; then
					cor_sts='#FF7F00'
				elif [[ "$sts_cor" = "8" ]] || [[ "$sts_cor" = "08" ]]; then
					cor_sts='#9932CD'
				elif [[ "$sts_cor" = "9" ]] || [[ "$sts_cor" = "09" ]]; then
					cor_sts='black'
				elif [[ "$sts_cor" = "10" ]]; then
					cor_sts='null'
				else
					echo -e "\n${YELLOW}${DIAMOND} ${WHITE}INVALID OPTION!"
					cor_sts='null'
				fi
				fun_msgsocks() {
					msgsocks2=$(cat /etc/VPSManager/proxy.py | grep "MSG =" | awk -F = '{print $2}')
					sed -i "s/$msgsocks2/ '$msgg'/g" /etc/VPSManager/proxy.py
					sleep 1
					cor_old=$(grep 'color=' /etc/VPSManager/proxy.py | cut -d '"' -f2)
					sed -i "s/\b$cor_old\b/$cor_sts/g" /etc/VPSManager/proxy.py
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}CHANGING STATUS!"
				echo ""
				fun_bar 'fun_msgsocks'
				restartsocks() {
					if ps x | grep proxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
						echo -e "$(netstat -nplt | grep 'python' | awk {'print $4'} | cut -d: -f2 | xargs)" >/tmp/Pt_sks
						for pidproxy in $(screen -ls | grep ".proxy" | awk {'print $1'}); do
							screen -r -S "$pidproxy" -X quit
						done
						screen -wipe >/dev/null
						_Ptsks="$(cat /tmp/Pt_sks)"
						sleep 1
						screen -dmS proxy python /etc/VPSManager/proxy.py $_Ptsks
						rm /tmp/Pt_sks
					fi
                }
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}RESTARTING PROXY SOCKS!"
				echo ""
				fun_bar 'restartsocks'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}STATUS SUCCESSFULLY CHANGED!"
				sleep 2
				fun_socks
			else
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}UNAVAILABLE FUNCTION\n\n${YELLOW}${DIAMOND} ${WHITE}ACTIVATE SOCKS SSH FIRST!${RESET}"
				sleep 2
				fun_socks
			fi
        elif [[ "$resposta" = '6' ]]; then
			if ps x | grep -w wsproxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
				print_header
				msgsocks=$(cat /etc/VPSManager/wsproxy.py | grep -E "MSG =" | awk -F = '{print $2}' | cut -d "'" -f 2)
				echo -e "${NEON_BLUE}${GEAR} ${WHITE}CHANGE WEBSOCKET STATUS${RESET}"
				echo ""
				echo -e "${YELLOW}${DIAMOND} ${WHITE}CURRENT STATUS: ${GREEN}$msgsocks"
				echo""
				echo -ne "${GREEN}${ARROW} ${WHITE}INFORM YOUR STATUS: ${GOLD}"
				read msgg
				[[ -z "$msgg" ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid status!"
					sleep 2
					fun_conexao
				}
				[[ ${msgg} != ?(+|-)+([a-zA-Z0-9-. ]) ]] && {
					echo -e "\n${RED}${CROSS_MARK} ${WHITE}AVOID SPECIAL CHARACTERS${RESET}"
					sleep 2
					fun_socks
				}
				echo -e "\n${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}01${RESET} ${ARROW} ${WHITE}BLUE                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}02${RESET} ${ARROW} ${WHITE}GREEN                       ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}03${RESET} ${ARROW} ${WHITE}RED                         ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}04${RESET} ${ARROW} ${WHITE}YELLOW                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}05${RESET} ${ARROW} ${WHITE}PINK                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}06${RESET} ${ARROW} ${WHITE}CYAN                        ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}07${RESET} ${ARROW} ${WHITE}ORANGE                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}08${RESET} ${ARROW} ${WHITE}PURPLE                      ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}09${RESET} ${ARROW} ${WHITE}BLACK                       ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îÇ ${YELLOW}10${RESET} ${ARROW} ${WHITE}NO COLOR                    ${CYAN}‚îÇ${RESET}"
				echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
				echo ""
				echo -ne "${GREEN}${ARROW} ${WHITE}WHICH COLOR ${YELLOW}? ${GOLD}"
				read sts_cor
				if [[ "$sts_cor" = "1" ]] || [[ "$sts_cor" = "01" ]]; then
					cor_sts='blue'
				elif [[ "$sts_cor" = "2" ]] || [[ "$sts_cor" = "02" ]]; then
					cor_sts='green'
				elif [[ "$sts_cor" = "3" ]] || [[ "$sts_cor" = "03" ]]; then
					cor_sts='red'
				elif [[ "$sts_cor" = "4" ]] || [[ "$sts_cor" = "04" ]]; then
					cor_sts='yellow'
				elif [[ "$sts_cor" = "5" ]] || [[ "$sts_cor" = "05" ]]; then
					cor_sts='#F535AA'
				elif [[ "$sts_cor" = "6" ]] || [[ "$sts_cor" = "06" ]]; then
					cor_sts='cyan'
				elif [[ "$sts_cor" = "7" ]] || [[ "$sts_cor" = "07" ]]; then
					cor_sts='#FF7F00'
				elif [[ "$sts_cor" = "8" ]] || [[ "$sts_cor" = "08" ]]; then
					cor_sts='#9932CD'
				elif [[ "$sts_cor" = "9" ]] || [[ "$sts_cor" = "09" ]]; then
					cor_sts='black'
				elif [[ "$sts_cor" = "10" ]]; then
					cor_sts='null'
				else
					echo -e "\n${YELLOW}${DIAMOND} ${WHITE}INVALID OPTION!"
					cor_sts='null'
				fi
				fun_msgsocks() {
					msgsocks2=$(cat /etc/VPSManager/wsproxy.py | grep "MSG =" | awk -F = '{print $2}')
					sed -i "s/$msgsocks2/ '$msgg'/g" /etc/VPSManager/wsproxy.py
					sleep 1
					cor_old=$(grep 'color=' /etc/VPSManager/wsproxy.py | cut -d '"' -f2)
					sed -i "s/\b$cor_old\b/$cor_sts/g" /etc/VPSManager/wsproxy.py
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}CHANGING STATUS!"
				echo ""
				fun_bar 'fun_msgsocks'
                restartwssocks() {
                    if ps x | grep wsproxy.py | grep -v grep 1>/dev/null 2>/dev/null; then
						echo -e "$(netstat -nplt | grep 'python' | awk {'print $4'} | cut -d: -f2 | xargs)" >/tmp/Pt_wssks
						for pidproxy in $(screen -ls | grep ".ws" | awk {'print $1'}); do
							screen -r -S "$pidproxy" -X quit
						done
						screen -wipe >/dev/null
						_Ptwssks="$(cat /tmp/Pt_wssks)"
						sleep 1
						screen -dmS ws python /etc/VPSManager/wsproxy.py $_Ptwssks
						rm /tmp/Pt_wssks
					fi
				}
				echo ""
				echo -e "${GREEN}${GEAR} ${WHITE}RESTARTING WEBSOCKET!"
				echo ""
				fun_bar 'restartwssocks'
				echo ""
				echo -e "${GREEN}${CHECK_MARK} ${WHITE}STATUS SUCCESSFULLY CHANGED!"
				sleep 2
				fun_socks
			else
				print_header
				echo -e "${RED}${CROSS_MARK} ${WHITE}UNAVAILABLE FUNCTION\n\n${YELLOW}${DIAMOND} ${WHITE}ACTIVATE WEBSOCKET FIRST!${RESET}"
				sleep 2
				fun_socks
			fi
		elif [[ "$resposta" = '0' ]]; then
			echo ""
			echo -e "${RED}${ARROW} ${WHITE}Returning...${RESET}"
			sleep 1
			fun_conexao
		else
			echo ""
			echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
			sleep 1
			fun_socks
		fi
	}

	fun_openssh() {
		print_header
		echo -e "${NEON_BLUE}${GEAR} ${WHITE}OPENSSH MANAGER${RESET}\n"
		echo -e "${CYAN}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}1${RESET} ${ARROW} ${WHITE}ADD PORT                     ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}2${RESET} ${ARROW} ${WHITE}REMOVE PORT                  ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îÇ ${YELLOW}3${RESET} ${ARROW} ${WHITE}BACK TO MENU                 ${CYAN}‚îÇ${RESET}"
		echo -e "${CYAN}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
		echo ""
		echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
		read resp
		if [[ "$resp" = '1' ]]; then
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}ADD PORT TO SSH${RESET}\n"
			echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO ADD ${YELLOW}? ${GOLD}"
			read pt
			[[ -z "$pt" ]] && {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid Port!"
				sleep 3
				fun_conexao
			}
			verif_ptrs $pt
			echo -e "\n${GREEN}${GEAR} ${WHITE}ADDING PORT TO SSH${RESET}"
			echo ""
			fun_addpssh() {
				echo "Port $pt" >>/etc/ssh/sshd_config
				service ssh restart
			}
			fun_bar 'fun_addpssh'
			echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY ADDED${RESET}"
			sleep 3
			fun_conexao
		elif [[ "$resp" = '2' ]]; then
			print_header
			echo -e "${RED}${CROSS_MARK} ${WHITE}REMOVE SSH PORT${RESET}"
			echo -e "\n${RED}${DIAMOND} ${WHITE}CAUTION! STANDARD PORT ${GOLD}22${RESET}"
			echo -e "\n${YELLOW}${DIAMOND} ${WHITE}PORTS IN USE: ${GREEN}$(grep 'Port' /etc/ssh/sshd_config | cut -d' ' -f2 | grep -v 'no' | xargs)\n"
			echo -ne "${GREEN}${ARROW} ${WHITE}WHICH PORT TO REMOVE ${YELLOW}? ${GOLD}"
			read pt
			[[ -z "$pt" ]] && {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid Port!"
				sleep 2
				fun_conexao
			}
			[[ $(grep -wc "$pt" '/etc/ssh/sshd_config') != '0' ]] && {
				echo -e "\n${GREEN}${GEAR} ${WHITE}REMOVING SSH PORT${RESET}"
				echo ""
				fun_delpssh() {
					sed -i "/Port $pt/d" /etc/ssh/sshd_config
					service ssh restart
				}
				fun_bar 'fun_delpssh'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}PORT SUCCESSFULLY REMOVED${RESET}"
				sleep 2
				fun_conexao
			} || {
				echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid Port!"
				sleep 2
				fun_conexao
			}
		elif [[ "$resp" = '3' ]]; then
			echo -e "\n${RED}${ARROW} ${WHITE}Returning..."
			sleep 2
			fun_conexao
		else
			echo -e "\n${RED}${CROSS_MARK} ${WHITE}Invalid option!"
			sleep 2
			fun_conexao
		fi
	}

	fun_sslh() {
		[[ "$(netstat -nltp | grep 'sslh' | wc -l)" = '0' ]] && {
			print_header
			echo -e "${NEON_BLUE}${GEAR} ${WHITE}SSLH INSTALLER${RESET}\n"
			echo -e "\n${RED}${DIAMOND} ${WHITE}PORT ${GOLD}443 ${WHITE}WILL BE USED BY DEFAULT${RESET}\n"
			echo -ne "${GREEN}${ARROW} ${WHITE}REALLY WANT TO INSTALL SSLH ${RED}? ${YELLOW}[s/n]:${GOLD} "
			read resp
			[[ "$resp" = 's' ]] && {
				verif_ptrs 443
				fun_instsslh() {
					[[ -e "/etc/stunnel/stunnel.conf" ]] && ptssl="$(netstat -nplt | grep 'stunnel' | awk {'print $4'} | cut -d: -f2 | xargs)" || ptssl='3128'
					[[ -e "/etc/openvpn/server.conf" ]] && ptvpn="$(netstat -nplt | grep 'openvpn' | awk {'print $4'} | cut -d: -f2 | xargs)" || ptvpn='1194'
					DEBIAN_FRONTEND=noninteractive apt-get -y install sslh
					echo -e "#standalone mode\n\nRUN=yes\n\nDAEMON=/usr/sbin/sslh\n\nDAEMON_OPTS='--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:$ptssl --http 127.0.0.1:80 --openvpn 127.0.0.1:$ptvpn --pidfile /var/run/sslh/sslh.pid'" >/etc/default/sslh
					/etc/init.d/sslh start && service sslh start
				}
				echo -e "\n${GREEN}${GEAR} ${WHITE}INSTALLING SSLH!${RESET}\n"
				fun_bar 'fun_instsslh'
				echo -e "\n${GREEN}${GEAR} ${WHITE}STARTING SSLH!${RESET}\n"
				fun_bar '/etc/init.d/sslh restart && service sslh restart'
				[[ $(netstat -nplt | grep -w 'sslh' | wc -l) != '0' ]] && echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SUCCESSFULLY INSTALLED!${RESET}" || echo -e "\n${RED}${CROSS_MARK} ${WHITE}UNEXPECTED ERROR!${RESET}"
				sleep 3
				fun_conexao
			} || {
				echo -e "\n${RED}${ARROW} ${WHITE}Returning..."
				sleep 2
				fun_conexao
			}
		} || {
			print_header
			echo -e "${RED}${CROSS_MARK} ${WHITE}REMOVE SSLH${RESET}\n"
			echo -ne "${GREEN}${ARROW} ${WHITE}REALLY WANT TO REMOVE SSLH ${RED}? ${YELLOW}[s/n]:${GOLD} "
			read respo
			[[ "$respo" = "s" ]] && {
				fun_delsslh() {
					/etc/init.d/sslh stop && service sslh stop
					apt-get remove sslh -y
					apt-get purge sslh -y
				}
				echo -e "\n${RED}${GEAR} ${WHITE}REMOVING SSLH!${RESET}\n"
				fun_bar 'fun_delsslh'
				echo -e "\n${GREEN}${CHECK_MARK} ${WHITE}SUCCESSFULLY REMOVED!${RESET}\n"
				sleep 2
				fun_conexao
			} || {
				echo -e "\n${RED}${ARROW} ${WHITE}Returning..."
				sleep 2
				fun_conexao
			}
		}
	}

	x="ok"
	fun_conexao() {
		while true $x != "ok"; do
			[[ ! -e '/home/vpsmanager' ]] && exit 0
			
			print_header
			echo ""
			echo -e "${PURPLE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${RESET}"
			echo -e "${PURPLE}‚ïë${WHITE}  ${GEAR} SYSTEM: ${CYAN}$(cut -d' ' -f1 /etc/issue.net)${WHITE} ${CLOCK} RAM: ${CYAN}$ram1 ${WHITE}CPU: ${YELLOW}$uso${PURPLE}‚ïë${RESET}"
			echo -e "${PURPLE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${RESET}"
			echo ""
			
			echo -e "${NEON_PURPLE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${RESET}"
			echo -e "${NEON_PURPLE}‚ïë${BLUE}${WHITE}                 ${SHIELD} CONNECTION MODE DASHBOARD ${SHIELD}                  ${RESET}${NEON_PURPLE}‚ïë${RESET}"
			echo -e "${NEON_PURPLE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${RESET}"
			echo ""

			# Service Status Display
			echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}OPENSSH ${GREEN}PORT: ${GOLD}$(grep 'Port' /etc/ssh/sshd_config | cut -d' ' -f2 | grep -v 'no' | xargs)" && sts6="${GREEN}${CHECK_MARK}"
			[[ "$(netstat -tlpn | grep 'docker' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}CHISEL: ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'docker' | awk {'print $4'} | cut -d: -f2 | xargs)"
				sts8="${GREEN}${CHECK_MARK}"
			} || {
				sts8="${RED}${CROSS_MARK}"
			}
			[[ "$(ps x | grep 'slow_dns' | grep -v 'grep'|wc -l)" != '0' ]] && {
				sts9="${GREEN}${CHECK_MARK}"
			} || {
				sts9="${RED}${CROSS_MARK}"
			}            
			[[ "$(netstat -tlpn | grep 'sslh' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}SSLH: ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'sslh' | awk {'print $4'} | cut -d: -f2 | xargs)"
				sts7="${GREEN}${CHECK_MARK}"
			} || {
				sts7="${RED}${CROSS_MARK}"
			}

			[[ "$(netstat -tlpn | grep 'openvpn' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}OPENVPN: ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'openvpn' | awk {'print $4'} | cut -d: -f2 | xargs)"
				sts5="${GREEN}${CHECK_MARK}"
			} || {
				sts5="${RED}${CROSS_MARK}"
			}

			[[ "$(netstat -tlpn | grep 'python' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}PROXY SOCKS ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'python' | awk {'print $4'} | cut -d: -f2 | xargs)"
				sts4="${GREEN}${CHECK_MARK}"
			} || {
				sts4="${RED}${CROSS_MARK}"
			}
			[[ -e "/etc/stunnel/stunnel.conf" ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}SSL TUNNEL ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'stunnel' | awk {'print $4'} | cut -d: -f2 | xargs)"
				sts3="${GREEN}${CHECK_MARK}"
			} || {
				sts3="${RED}${CROSS_MARK}"
			}
			[[ "$(netstat -tlpn | grep 'dropbear' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}DROPBEAR ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'dropbear' | awk -F ":" {'print $4'} | xargs)"
				sts2="${GREEN}${CHECK_MARK}"
			} || {
				sts2="${RED}${CROSS_MARK}"
			}
			[[ "$(netstat -tlpn | grep 'squid' | wc -l)" != '0' ]] && {
				echo -e "${GREEN}${GEAR} ${WHITE}SERVICE: ${YELLOW}SQUID ${GREEN}PORT: ${GOLD}$(netstat -nplt | grep 'squid' | awk -F ":" {'print $4'} | xargs)"
				sts1="${GREEN}${CHECK_MARK}"
			} || {
				sts1="${RED}${CROSS_MARK}"
			}
			echo ""
			echo -e "${ELECTRIC_BLUE}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}01${RESET} ${ARROW} ${WHITE}OPENSSH $sts6              ${ELECTRIC_BLUE}‚îÇ ${GOLD}06${RESET} ${ARROW} ${WHITE}SSL TUNNEL $sts3           ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}02${RESET} ${ARROW} ${WHITE}SQUID PROXY $sts1           ${ELECTRIC_BLUE}‚îÇ ${GOLD}07${RESET} ${ARROW} ${WHITE}SSLH MULTIPLEX $sts7       ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}03${RESET} ${ARROW} ${WHITE}DROPBEAR $sts2              ${ELECTRIC_BLUE}‚îÇ ${GOLD}08${RESET} ${ARROW} ${WHITE}CHISEL $sts8               ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}04${RESET} ${ARROW} ${WHITE}OPENVPN $sts5               ${ELECTRIC_BLUE}‚îÇ ${GOLD}09${RESET} ${ARROW} ${WHITE}SLOWDNS $sts9              ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}05${RESET} ${ARROW} ${WHITE}PROXY SOCKS $sts4           ${ELECTRIC_BLUE}‚îÇ ${GOLD}10${RESET} ${ARROW} ${NEON_GREEN}BACK TO MAIN           ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îÇ ${GOLD}00${RESET} ${ARROW} ${RED}EXIT APPLICATION                              ${ELECTRIC_BLUE}‚îÇ${RESET}"
			echo -e "${ELECTRIC_BLUE}‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò${RESET}"

			print_footer

			tput civis
			echo -ne "${GREEN}${ARROW} ${WHITE}SELECT OPTION ${YELLOW}? ${GOLD}"
			read x
			tput cnorm
			case $x in
			1 | 01)
				fun_openssh
				;;
			2 | 02)
				fun_squid
				;;
			3 | 03)
				fun_drop
				;;
			4 | 04)
				fun_openvpn
				;;
			5 | 05)
				fun_socks
				;;
			6 | 06)
				inst_ssl
				;;
			7 | 07)
				fun_sslh
				;;
		    8 | 08)
				fun_chisel
                ;;              
		    9 | 09)
				slow_dns
				;;
			10 | 10)
				menu
				;;
			0 | 00)
				echo -e "${RED}${ARROW} ${WHITE}Exiting MAPTECH system...${RESET}"
				sleep 2
				clear
				exit
				;;
			*)
				echo -e "${RED}${CROSS_MARK} ${WHITE}Invalid option!${RESET}"
				sleep 2
				;;
			esac
		done
	}
	fun_conexao
}
